<div class="card px-12 py-10 mt-8">
  <div class="d-flex flex-ac justify-content-between">
    <!-- 可提取的奖金 -->
    <div class="d-flex align-items-center">
      <span class="text-muted">{{ 'member.detail.nonsticky.withdrawable' | lang }}</span>
      <!-- triggers="mouseenter:mouseleave" -->
      <svg-icon
        *ngIf="list?.cashableBonusInfos?.length"
        [ngbPopover]="customPopoverHtml"
        triggers="mouseenter:mouseleave"
        class="svg-icon svg-icon-sm ml-2 mb-1"
        [src]="'./assets/images/svg/sigh.svg'"
      ></svg-icon>
      <span class="d-flex align-items-center ml-2">
        {{ list?.cashableBonus | currencyValue: 'USDT' }}<img [currencyIcon]="'USDT'" currencySize="18" class="ml-2"
      /></span>
    </div>
    <!-- 锁定奖金 -->
    <div class="d-flex align-items-center">
      <span class="text-muted">{{ 'member.detail.nonsticky.lockBonus' | lang }}</span>
      <span class="d-flex align-items-center ml-2">
        {{ list?.lockedBonus | currencyValue: 'USDT' }}<img [currencyIcon]="'USDT'" currencySize="18" class="ml-2"
      /></span>
    </div>
    <!-- 娱乐场奖金 -->
    <div class="d-flex align-items-center">
      <span class="text-muted">{{ 'member.detail.nonsticky.casinoBonus' | lang }}</span>
      <span class="d-flex align-items-center ml-2">
        {{ list?.casinoBonus | currencyValue: 'USDT' }}<img [currencyIcon]="'USDT'" currencySize="18" class="ml-2"
      /></span>
    </div>
    <!--真人娱乐场奖金 -->
    <div class="d-flex align-items-center">
      <span class="text-muted">{{ 'member.detail.nonsticky.liveCasino' | lang }}</span>
      <span class="d-flex align-items-center ml-2">
        {{ list?.liveCasinoBonus | currencyValue: 'USDT' }}<img [currencyIcon]="'USDT'" currencySize="18" class="ml-2"
      /></span>
    </div>
  </div>
</div>
<div class="card px-12 py-10 mt-8">
  <div class="d-flex flex-ac flex-wrap">
    <ng-container *ngFor="let item of bonusBtns; let idx = index">
      <button
        [class]="item?.checked ? 'btn-primary' : 'btn-default'"
        class="btn text-nowrap px-6 mx-2 my-2"
        (click)="toggleBonusType(item)"
      >
        {{ item.lang | lang }}
      </button>
    </ng-container>
  </div>
</div>
<div class="card px-12 py-10 mt-8">
  <!-- 激活的奖金 -->
  <table class="table mb-0" *ngIf="type === 'Activated' && list?.bonus">
    <thead>
      <tr>
        <!-- 奖品名次 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.prizeName' | lang }}</span>
        </th>
        <!-- 奖金类型 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.bonusType' | lang }}</span>
        </th>
        <!-- 活动名称 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.eventName' | lang }}</span>
        </th>
        <!-- 金额 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.initialAmount' | lang }}</span>
        </th>
        <!-- 当前奖金余额-->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.awardBalance' | lang }}</span>
        </th>
        <!-- 提取金额-->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.withdrawalAmount' | lang }}</span>
        </th>
        <!-- 投注流水 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.bettingTurnover' | lang }}</span>
        </th>
        <!-- 剩余投注额 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.remainingBet' | lang }}</span>
        </th>
        <!-- 投注进度 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.bettingProgress' | lang }}</span>
        </th>
        <!-- 投注次数 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.numberBets' | lang }}</span>
        </th>
        <!-- 状态 -->
        <th>
          <span class="cell">{{ 'common.status' | lang }}</span>
        </th>
        <!-- 操作 -->
        <th>
          <span class="cell">{{ 'common.operate' | lang }}</span>
        </th>
      </tr>
    </thead>

    <tbody class="color-222">
      <tr *ngFor="let item of list?.bonus">
        <td>
          <div class="cell">
            <span>{{ item.prizeName || '-' }}</span>
          </div>
        </td>
        <!-- 奖品类型翻译 -->
        <td>
          <div class="cell">
            <span>{{ item.prizeTypeDesc || '-' }}</span>
          </div>
        </td>
        <!-- 活动名称 -->
        <td>
          <div class="cell">
            <span>{{ item.activityName || '-' }}</span>
          </div>
        </td>
        <!-- 金额 -->
        <td>
          <div class="cell">
            <span>{{ item.amount | currencyValue: item.currency }}</span>
            <img [currencyIcon]="item.currency" currencySize="18" class="ml-2" />
          </div>
        </td>
        <!-- 当前奖金余额 -->
        <td>
          <div class="cell">
            <span>{{ item.balance | currencyValue: item.currency }}</span>
            <img [currencyIcon]="item.currency" currencySize="18" class="ml-2" />
          </div>
        </td>
        <!-- 提取金额 -->
        <td>
          <div class="cell">
            <span>{{ item.withdrawAmount | currencyValue: item.currency }}</span>
            <img [currencyIcon]="item.currency" currencySize="18" class="ml-2" />
          </div>
        </td>
        <!-- 投注流水 -->
        <td>
          <div class="cell">
            <span>{{ item.currentBetTurnover | currencyValue: item.currency }}</span>
            <img [currencyIcon]="item.currency" currencySize="18" class="ml-2" />
          </div>
        </td>
        <!-- 剩余投注额 -->
        <td>
          <div class="cell">
            <span>{{ item.laveBetTurnover | currencyValue: item.currency }}</span>
            <img [currencyIcon]="item.currency" currencySize="18" class="ml-2" />
          </div>
        </td>
        <!-- 投注进度 -->
        <td>
          <div class="cell">
            <span>{{ item.betProgress }}%</span>
          </div>
        </td>
        <!-- 投注次数 -->
        <td>
          <div class="cell">
            <span>{{ item.betCount }}</span>
          </div>
        </td>
        <!-- 状态 -->
        <td>
          <div class="cell">
            <span>{{ item.statusDesc }}</span>
          </div>
        </td>
        <!-- 操作 -->
        <td>
          <div class="cell">
            <span
              class="text-primary cursor-pointer text-nowrap"
              (click)="onCancelActive(item)"
              *ngIf="item.status === 'Activated'"
              >{{ 'member.detail.nonsticky.abandon2' | lang }}</span
            >
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <!-- 符合资格的奖金 -->
  <table class="table mb-0" *ngIf="type === 'Pending' && list?.bonus">
    <thead>
      <tr>
        <!-- 奖品名次 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.prizeName' | lang }}</span>
        </th>
        <!-- 奖金类型 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.bonusType' | lang }}</span>
        </th>
        <!-- 来源 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.source' | lang }}</span>
        </th>
        <!-- 活动名称 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.eventName' | lang }}</span>
        </th>
        <!-- 金额 -->
        <th>
          <span class="cell">{{ 'member.detail.nonsticky.amount' | lang }}</span>
        </th>
        <!-- 状态 -->
        <th>
          <span class="cell">{{ 'common.status' | lang }}</span>
        </th>
      </tr>
    </thead>

    <tbody class="color-222">
      <tr *ngFor="let item of list?.bonus">
        <td>
          <div class="cell">
            <span class="mr-4">{{ item.prizeName || '-' }}</span>
          </div>
        </td>
        <!-- 奖品类型翻译 -->
        <td>
          <div class="cell">
            <span class="mr-4">{{ item.prizeTypeDesc || '-' }}</span>
          </div>
        </td>
        <!-- source 来源-->
        <td>
          <div class="cell">
            <span class="mr-4">{{ item.source || '-' }}</span>
          </div>
        </td>
        <!-- 活动名称 -->
        <td>
          <div class="cell">
            <span class="mr-4">{{ item.activityName || '-' }}</span>
          </div>
        </td>
        <!-- 金额 -->
        <td>
          <div class="cell">
            <span class="mr-4">{{ item.balance | currencyValue: item?.currency }}</span>
            <img [currencyIcon]="item?.currency" currencySize="18" class="ml-2" />
          </div>
        </td>
        <!-- 状态 -->
        <td>
          <div class="cell">
            <span>{{ item.statusDesc }}</span>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <!-- 空显示 -->
  <empty *ngIf="!list?.bonus?.length && !isLoading"></empty>
  <div class="d-flex flex-between pt-30">
    <div>
      <mat-form-field [style.width.px]="68">
        <mat-select
          class="form-control rounded-0"
          [(ngModel)]="paginator.pageSize"
          [style.height.px]="34"
          [style.font-size.px]="14"
          (selectionChange)="loadData(true)"
        >
          <mat-option *ngFor="let size of pageSizes" [value]="size">{{ size }}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div *ngIf="paginator.total">
      <app-paginator
        class="paginator d-flex justify-content-between align-items-center flex-wrap"
        [paginator]="paginator"
        (paginate)="loadData()"
        [isLoading]="appService.isContentLoadingSubject | async"
      ></app-paginator>
    </div>
  </div>
</div>

<ng-template #customPopoverHtml>
  <!-- 可解锁金额 -->
  <div [style.width.px]="180">
    <div
      [style.height.px]="24"
      class="d-flex justify-content-between flex-ac"
      *ngFor="let item of list?.cashableBonusInfos"
    >
      <div class="d-flex flex-ac h-100">
        <img class="vam mr-2" [currencyIcon]="item?.currency" />
        <span>{{ item?.currency }}</span>
      </div>
      <div class="d-flex flex-ac h-100">{{ item?.amount | currencyValue: item?.currency }}</div>
    </div>
  </div>
</ng-template>
